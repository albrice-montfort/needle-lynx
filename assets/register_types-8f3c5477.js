import{Behaviour as p,Mathf as a,serializeable as n,WaitForSeconds as _,PlayableDirector as f,serializable as b,TypeStore as d}from"./needle-engine-773a00d6.js";import"./three.module-492dddd8.js";import"./index-e9a5981f.js";class g extends p{constructor(){super(...arguments),this.targetRotation=0,this.maxRotation=.1}update(){const e=this.context.input.getPointerPositionRC(0);e&&(this.targetRotation=e.x*this.maxRotation,this.gameObject.rotation.y=a.lerp(this.gameObject.rotation.y,this.targetRotation,this.context.time.deltaTime))}}var w=Object.defineProperty,S=Object.getOwnPropertyDescriptor,c=(o,e,s,i)=>{for(var t=i>1?void 0:i?S(e,s):e,r=o.length-1,l;r>=0;r--)(l=o[r])&&(t=(i?l(e,s,t):l(t))||t);return i&&t&&w(e,s,t),t};class h extends p{constructor(){super(...arguments),this.startOffset=0,this.lerpSpeed=2.5,this.startLerpSpeed=.5}start(){const e=this.context.mainCameraComponent;if(!e)return;const s=e.fieldOfView;new ResizeObserver(t=>{let r=s;const l=a.clamp(this.context.domWidth/this.context.domHeight/1.77777777,.25,3.5);r/=a.lerp(l,1,.2),e.fieldOfView=r}).observe(this.context.domElement)}onEnable(){this.updateTimelineCoroutine=this.updateTimeline(),this.startCoroutine(this.updateTimelineCoroutine),this.context.scene.backgroundBlurriness=1}onDisable(){this.stopCoroutine(this.updateTimelineCoroutine)}*updateTimeline(){if(yield _(1),!!this.timeline){for(this.timeline.play();this.timeline.time<this.startOffset;)yield;for(;this.enabled;){if(this.timeline){this.timeline.isPlaying&&this.timeline.pause();const e=this.timeline.duration-this.startOffset,s=window.scrollY/(document.body.scrollHeight-window.innerHeight);this.timeline.time=a.lerp(this.timeline.time,s*e+this.startOffset,this.context.time.deltaTime*this.lerpSpeed),this.timeline.evaluate()}yield}}}}c([n(f)],h.prototype,"timeline",2);c([n()],h.prototype,"startOffset",2);c([n()],h.prototype,"lerpSpeed",2);c([n()],h.prototype,"startLerpSpeed",2);var O=Object.defineProperty,T=Object.getOwnPropertyDescriptor,y=(o,e,s,i)=>{for(var t=i>1?void 0:i?T(e,s):e,r=o.length-1,l;r>=0;r--)(l=o[r])&&(t=(i?l(e,s,t):l(t))||t);return i&&t&&O(e,s,t),t};class v extends p{constructor(){super(...arguments),this._slider=null}onEnable(){this.timeline&&(this._slider||(this._slider=document.createElement("input"),this._slider.type="range",this._slider.min="0",this._slider.max=this.timeline.duration.toString(),this._slider.step="0.0001",this._slider.value=(this.timeline.duration*.2).toString(),this._slider.style.cssText=`
            position: absolute;
            bottom: 8%;
            margin: 0 auto;
            width: 50%;
            left: 25%;
            `,this._slider.oninput=()=>{this.timeline.time=parseFloat(this._slider.value),this.timeline.evaluate()},this.timeline.pause(),this.timeline.playOnAwake=!1,this.timeline.time=parseFloat(this._slider.value),this.timeline.evaluate()),this.context.domElement.appendChild(this._slider))}onDisable(){var e;(e=this._slider)==null||e.remove()}}y([b(f)],v.prototype,"timeline",2);var x=Object.defineProperty,P=Object.getOwnPropertyDescriptor,u=(o,e,s,i)=>{for(var t=i>1?void 0:i?P(e,s):e,r=o.length-1,l;r>=0;r--)(l=o[r])&&(t=(i?l(e,s,t):l(t))||t);return i&&t&&x(e,s,t),t};class m extends p{constructor(){super(...arguments),this.scrollSpeed=.5,this.mobileScrollFactor=2,this.lerpSpeed=2.5,this.targetTime=0}start(){var s;(s=this.timeline)==null||s.pause(),window.addEventListener("wheel",i=>this.updateTime(i.deltaY));let e=-1;window.addEventListener("touchstart",i=>{e=i.touches[0].clientY}),window.addEventListener("touchmove",i=>{let t=i.touches[0].clientY-e;t*=this.mobileScrollFactor,t/=window.devicePixelRatio,this.updateTime(-t),e=i.touches[0].clientY})}updateTime(e){this.timeline&&(this.targetTime+=e*.01*this.scrollSpeed,this.targetTime=a.clamp(this.targetTime,0,this.timeline.duration))}onBeforeRender(){this.timeline&&(this.timeline.pause(),this.timeline.time=a.lerp(this.timeline.time,this.targetTime,this.lerpSpeed*this.context.time.deltaTime),this.timeline.evaluate())}}u([n(f)],m.prototype,"timeline",2);u([n()],m.prototype,"scrollSpeed",2);u([n()],m.prototype,"mobileScrollFactor",2);u([n()],m.prototype,"lerpSpeed",2);d.add("MouseRotation",g);d.add("ScrollTimeline",h);d.add("ScrollTimelineSlider",v);d.add("ScrollTimeline_2",m);
